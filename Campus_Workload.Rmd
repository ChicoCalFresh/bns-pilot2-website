---
title: "Workload by Campus"
output: 
  html_document: 
    toc: yes
    toc_float: yes
    css: styles.css
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
source("common_code.R")
library(ggforce)

tmp2 <- data.frame(q18=bns$q18, q19=bns$q19, q21=bns$q21, school=bns$school) %>% 
  mutate(q18=recode(q18, "22+"="22"), q18=as.numeric(q18),
         q19=recode(q19, "41+"="41"), q19=as.numeric(q19),
         q21=recode(q21, "41+"="41"), q21=as.numeric(q21))
tmp2$units <- tmp2$q18*3
tmp2$NonAcademic <- rowSums(tmp2[, c('q19','q21')], na.rm = TRUE)
tmp2$TotalHours <- rowSums(tmp2[, c('units','NonAcademic')], na.rm = TRUE)
```
The following is a comparison across the 3 campuses (Chico, Fresno, and Northridge) for information relating to the workload taken on by students, both academic and non-academic. This includes both paid/unpaid hours worked per week, as well as the academic workload taken on by students. A total of the hours worked each week is also looked at for each campus. The purpose is to see if any key differences are seen between the campuses, or if similar information is captured among them.

## Paid Hours Per Week
```{r, fig.height=4.6, fig.width=8.5}
bns$paid_work_hours <- fct_relevel(factor(bns$paid_work_hours), "0", "1-5", "6-10")

plot_grpfrq(bns$paid_work_hours, bns$school, wrap.legend.labels = 30, geom.colors = campus.colors, legend.title = "", show.prc = FALSE) + 
  xlab('') + theme(legend.position="top")
```

### Exact Hour Breakdown
*Note: below hours were filtered to only include people that worked (> 0 hours) a paid job. The value "41+" was also rounded to 41 for the graph/calculations.* 
```{r, fig.height=8, fig.width=8}
tmp <- tmp2 %>% filter(q19 > 0)
# plot_grpfrq(tmp$q19, tmp$school, type="violin", wrap.labels = 25, geom.colors = campus.colors,
#             inner.box.dotsize = 3.5, inner.box.width = 0.2, title = "", show.ci = TRUE) + 
#   geom_sina(maxwidth=0.55, alpha=0.4, seed=54) + scale_y_continuous(breaks=seq(0,50,5), labels=seq(0,50,5)) +
#   xlab('') + ylab("Weekly Paid Hours") + coord_flip()

ggplot(tmp, aes(x=q19, group=school, fill=school, color=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v") + xlab('Weekly Paid Hours') + ylab("") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_color_manual(values=campus.colors) + 
  scale_x_continuous(breaks=seq(1,41,5), labels=c(as.character(seq(1,36,5)), "41+"))

```
Looking at the breakdown of both graphs, the distribution of paid weekly hours worked across all campuses seem to be mostly similar. CSU Northridge has a mean value of `r unname(round(tapply(tmp$q19, tmp$school, mean)[3],2))` hours and a median of `r unname(round(tapply(tmp$q19, tmp$school, median)[3],2))` hours.  CSU Fresno, which seems to have students who tend to work more hours, has a mean value of `r unname(round(tapply(tmp$q19, tmp$school, mean)[2],2))` hours and a median of `r unname(round(tapply(tmp$q19, tmp$school, median)[2],2))` hours. CSU Chico has a mean value of `r unname(round(tapply(tmp$q19, tmp$school, mean)[1],2))` hours and a median of `r unname(round(tapply(tmp$q19, tmp$school, median)[1],2))` hours.


## Unpaid Hours Per Week
```{r, fig.height=4.6, fig.width=8.5}
bns$unpaid_work_hours <- fct_relevel(factor(bns$unpaid_work_hours), "0", "1-5", "6-10")

plot_grpfrq(bns$unpaid_work_hours, bns$school, wrap.legend.labels = 30, geom.colors = campus.colors, legend.title = "", show.prc = FALSE) + 
  xlab('') + theme(legend.position="top")
```

### Exact Hour Breakdown
*Note: below hours were filtered to only include people that worked (> 0 hours) an unpaid job. The value "41+" was also rounded to 41 for the graph/calculations.*
```{r, fig.height=8, fig.width=8}
tmp <- tmp2 %>% filter(q21> 0)
# plot_grpfrq(tmp$q21, tmp$school, type="violin", wrap.labels = 25, geom.colors = campus.colors,
#             inner.box.dotsize = 3.5, inner.box.width = 0.12, title = "", show.ci = TRUE) + 
#   geom_sina(maxwidth=0.55, alpha=0.4, seed=54) + scale_y_continuous(breaks=seq(0,50,5), labels=seq(0,50,5)) +
#   xlab('') + ylab("Weekly Unpaid Hours") + coord_flip()

ggplot(tmp, aes(x=q21, group=school, fill=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v") + xlab('Weekly Unpaid Hours') + ylab("") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=seq(1,41,5), labels=c(as.character(seq(1,36,5)), "41+"))
```
Looking at the breakdown of both graphs, the distribution of unpaid weekly hours worked for Northridge and Fresno seem to be almost identical while Chico seems to have students who work more unpaid weekly hours. CSU Northridge has a mean value of `r unname(round(tapply(tmp$q21, tmp$school, mean)[3],2))` hours and a median of `r unname(round(tapply(tmp$q21, tmp$school, median)[3],2))` hours.  CSU Fresno has a mean value of `r unname(round(tapply(tmp$q21, tmp$school, mean)[2],2))` hours and a median of `r unname(round(tapply(tmp$q21, tmp$school, median)[2],2))` hours. CSU Chico has a mean value of `r unname(round(tapply(tmp$q21, tmp$school, mean)[1],2))` hours and a median of `r unname(round(tapply(tmp$q21, tmp$school, median)[1],2))` hours.


## Academic Hours
```{r, fig.height=5, fig.width=7}
# ggplot(data=tmp2, aes(x=units, fill=school)) + geom_histogram() + facet_wrap(~school, dir="v") + xlab('') + ylab("") + 
#   theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
#   scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=seq(0,66,6), labels=seq(0,66,6))

tmp <- tmp2 %>% filter(units > 0)

plot_grpfrq(tmp$units, tmp$school, type="boxplot", title = "", wrap.legend.labels = 50, geom.colors = campus.colors, show.ci = TRUE) + 
  geom_jitter(width=0.15, alpha=0.4) + xlab("") + scale_y_continuous(breaks=seq(0,70,10), labels=seq(0,70,10)) + ylab('Academic Hours')
```
*Note: values corresponding to "22+" were rounded to 22. Values were also filtered so that only people who take classes (> 0 hours per week) were included.*

Looking at the academic hours across each campus, it seems that the distribution seems very similar for each. CSU Chico has an average unit workload of `r unname(round(tapply(tmp$units, tmp$school, mean, na.rm=TRUE),2)[1])` units, and a median of `r unname(round(tapply(tmp$units, tmp$school, median, na.rm=TRUE),2)[1])` units. CSU Fresno has an average unit workload of `r unname(round(tapply(tmp$units, tmp$school, mean, na.rm=TRUE),2)[2])` units, and a median of `r unname(round(tapply(tmp$units, tmp$school, median, na.rm=TRUE),2)[2])` units. CSU Northridge has an average unit workload of `r unname(round(tapply(tmp$units, tmp$school, mean, na.rm=TRUE),2)[3])` units, and a median of `r unname(round(tapply(tmp$units, tmp$school, median, na.rm=TRUE),2)[3])` units.

## Non-Academic Hours
```{r, fig.height=5, fig.width=7}
tmp <- tmp2 %>% filter(NonAcademic > 0)

# ggplot(data=tmp, aes(x=TotalHours, fill=school)) + geom_histogram(bins=41) + facet_wrap(~school, dir="v") + xlab('') + ylab("") + 
#   theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
#   scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=seq(2,82,4), labels=seq(2,82,4))

plot_grpfrq(tmp$NonAcademic, tmp$school, type="boxplot", title = "", wrap.legend.labels = 50, geom.colors = campus.colors, show.ci = TRUE) + 
  geom_jitter(width=0.15, alpha=0.5) + xlab("") + scale_y_continuous(breaks=seq(0,90,10), labels=seq(0,90,10)) + ylab('Non-Academic Hours')
```
*Note: values corresponding to "41+" were rounded to 41. Values were also filtered so that only people who work (> 0 hours per week) were included.*

Looking at the non-academic workload across each campus, it seems the distributions are similar for Fresno and Northridge while Chico seems to have students who work more paid/unpaid weekly hours. CSU Chico has an average non-academic workload of `r unname(round(tapply(tmp$NonAcademic, tmp$school, mean, na.rm=TRUE),2)[1])` hours, and a median of `r unname(round(tapply(tmp$NonAcademic, tmp$school, median, na.rm=TRUE),2)[1])` hours. CSU Fresno has an average non-academic workload of `r unname(round(tapply(tmp$NonAcademic, tmp$school, mean, na.rm=TRUE),2)[2])` hours, and a median of `r unname(round(tapply(tmp$NonAcademic, tmp$school, median, na.rm=TRUE),2)[2])` hours. CSU Northridge has an average non-academic workload of `r unname(round(tapply(tmp$NonAcademic, tmp$school, mean, na.rm=TRUE),2)[3])` hours, and a median of `r unname(round(tapply(tmp$NonAcademic, tmp$school, median, na.rm=TRUE),2)[3])` hours.

## Total Workload Hours
```{r, fig.height=5, fig.width=7}
tmp <- tmp2 %>% filter(TotalHours > 0)

plot_grpfrq(tmp$TotalHours, tmp$school, type="boxplot", title = "", wrap.legend.labels = 50, geom.colors = campus.colors, show.ci = TRUE) +
  geom_jitter(width=0.15, alpha=0.5) + xlab("") + scale_y_continuous(breaks=seq(0,150,15), labels=seq(0,150,15)) + ylab('Total Hours')
```
*Note: values corresponding to "41+" were rounded to 41, as well as values corresponding to "22+" being rounded to 22. Values were also filtered so that only people who work (> 0 hours per week) were included.*

Looking at the total workload hours across each campus, again it seems that the distribution are very similar for each. CSU Chico has an average total workload of `r unname(round(tapply(tmp$TotalHours, tmp$school, mean, na.rm=TRUE),2)[1])` hours, and a median of `r unname(round(tapply(tmp$TotalHours, tmp$school, median, na.rm=TRUE),2)[1])` hours. CSU Fresno has an average total workload of `r unname(round(tapply(tmp$TotalHours, tmp$school, mean, na.rm=TRUE),2)[2])` hours, and a median of `r unname(round(tapply(tmp$TotalHours, tmp$school, median, na.rm=TRUE),2)[2])` hours. CSU Northridge has an average total workload of `r unname(round(tapply(tmp$TotalHours, tmp$school, mean, na.rm=TRUE),2)[3])` hours, and a median of `r unname(round(tapply(tmp$TotalHours, tmp$school, median, na.rm=TRUE),2)[3])` hours. A small number of students also claim to work over 100 hours per week across academic and non-academic jobs.

---

## [Student Demographics](Campus_Student_Demo.html)
*Click here to go to the Personal Demographics page.*

## [Personal Demographics](Campus_Personal_Demo.html)
*Click here to go to the Personal Demographics page.*