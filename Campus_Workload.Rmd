---
title: "Workload by Campus"
output: 
  html_document: 
    toc: yes
    toc_float: yes
    css: styles.css
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
source("common_code.R")
library(ggforce)

tmp2 <- data.frame(q18=bns$q18, q19=bns$q19, q21=bns$q21, school=bns$school) %>% 
  mutate(q18=recode(q18, "22+"="22"), q18=as.numeric(q18),
         q19=recode(q19, "41+"="41"), q19=as.numeric(q19),
         q21=recode(q21, "41+"="41"), q21=as.numeric(q21))
tmp2$units <- tmp2$q18*3
tmp2$NonAcademic <- ifelse(is.na(tmp2[,'q19']) & is.na(tmp2[,"q21"]), NA,  rowSums(tmp2[, c('q19','q21')], na.rm = TRUE))
tmp2$TotalHours <- ifelse(is.na(tmp2[, 'units']) & is.na(tmp2[,'NonAcademic']), NA,  rowSums(tmp2[, c('units','NonAcademic')], na.rm = TRUE))
```
The following is a comparison across the 3 campuses (Chico, Fresno, and Northridge) for information relating to the workload taken on by students, both academic and non-academic. This includes both paid/unpaid hours worked per week, as well as the academic workload taken on by students. A total of the hours worked each week is also looked at for each campus. The purpose is to see if any key differences are seen between the campuses, or if similar information is captured among them.

## Paid Hours Per Week
**Estimate the number of hours you work in a PAID job (for example, server at a restaurant, office assistant, etc.) or paid internship (for example, training, shadowing, or practicum) per week `r print_n_reporting('paid_work_hours')`**
```{r, fig.height=4.6, fig.width=8.5}
bns$paid_work_hours <- fct_relevel(factor(bns$paid_work_hours), "0", "1-5", "6-10")

plot_grpfrq(bns$paid_work_hours, bns$school, wrap.legend.labels = 30, geom.colors = campus.colors, legend.title = "", show.prc = FALSE) + 
  xlab('') + theme(legend.position="top")
```

### Exact Hour Breakdown
```{r}
tmp <- tmp2 %>% filter(q19 > 0 | is.na(q19))
```
**`r print_n_reporting_tmp('q19')`** *Note: below hours were filtered to only include people that worked (> 0 hours) a paid job. The value "41+" was also rounded to 41 for the graph/calculations.* 
```{r, fig.height=8, fig.width=8}
ggplot(tmp, aes(x=q19, group=school, fill=school, color=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v", scales='free') + xlab('Weekly Paid Hours') + ylab("Density") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_color_manual(values=campus.colors) + 
  scale_x_continuous(breaks=seq(1,41,5), labels=c(as.character(seq(1,36,5)), "41+"))

```
Looking at the breakdown of both graphs, the distribution of paid weekly hours worked across all campuses seem to be mostly similar. CSU Northridge has a mean value of `r unname(round(tapply(tmp$q19, tmp$school, mean)[3],2))` hours and a median of `r unname(round(tapply(tmp$q19, tmp$school, median)[3],2))` hours.  CSU Fresno, which seems to have students who tend to work more hours, has a mean value of `r unname(round(tapply(tmp$q19, tmp$school, mean)[2],2))` hours and a median of `r unname(round(tapply(tmp$q19, tmp$school, median)[2],2))` hours. CSU Chico has a mean value of `r unname(round(tapply(tmp$q19, tmp$school, mean)[1],2))` hours and a median of `r unname(round(tapply(tmp$q19, tmp$school, median)[1],2))` hours.


## Unpaid Hours Per Week
**Estimate the number of hours you work in an UNPAID internship (for example, training, shadowing, practicum, and/or volunteer, etc.). Do not combine with answers above `r print_n_reporting('unpaid_work_hours')`**
```{r, fig.height=4.6, fig.width=8.5}
bns$unpaid_work_hours <- fct_relevel(factor(bns$unpaid_work_hours), "0", "1-5", "6-10")

plot_grpfrq(bns$unpaid_work_hours, bns$school, wrap.legend.labels = 30, geom.colors = campus.colors, legend.title = "", show.prc = FALSE) + 
  xlab('') + theme(legend.position="top")
```

### Exact Hour Breakdown
```{r}
tmp <- tmp2 %>% filter(q21> 0 | is.na(q21))
```
**`r print_n_reporting_tmp('q21')`**  
*Note: below hours were filtered to only include people that worked (> 0 hours) an unpaid job. The value "41+" was also rounded to 41 for the graph/calculations.*
```{r, fig.height=8, fig.width=8}
ggplot(tmp, aes(x=q21, group=school, fill=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v", scales='free') + xlab('Weekly Unpaid Hours') + ylab("Density") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=seq(1,41,5), labels=c(as.character(seq(1,36,5)), "41+"))
```
Looking at the breakdown of both graphs, the distribution of unpaid weekly hours worked for Northridge and Fresno seem to be almost identical while Chico seems to have students who work more unpaid weekly hours. CSU Northridge has a mean value of `r unname(round(tapply(tmp$q21, tmp$school, mean)[3],2))` hours and a median of `r unname(round(tapply(tmp$q21, tmp$school, median)[3],2))` hours.  CSU Fresno has a mean value of `r unname(round(tapply(tmp$q21, tmp$school, mean)[2],2))` hours and a median of `r unname(round(tapply(tmp$q21, tmp$school, median)[2],2))` hours. CSU Chico has a mean value of `r unname(round(tapply(tmp$q21, tmp$school, mean)[1],2))` hours and a median of `r unname(round(tapply(tmp$q21, tmp$school, median)[1],2))` hours.


## Academic Hours
```{r}
tmp <- tmp2 %>% filter(units > 0 | is.na(units))
```
**Below is a breakdown of the academic workload using the 3 hours of work per unit measurement `r print_n_reporting_tmp('units')`**  
*Note: below the values corresponding to "22+" were rounded to 22. Values were also filtered so that only people who take classes (> 0 hours per week) were included.*
```{r, fig.height=8, fig.width=8}
ggplot(tmp, aes(x=units, group=school, fill=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v", scales='free') + xlab('Academic Hours') + ylab("Density") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=c(seq(9,59,7), 66), labels=c(as.character(seq(9,59,7)), "66+"))
```
Looking at the academic hours across each campus, it seems that the distribution seems very similar for each. CSU Chico has an average unit workload of `r unname(round(tapply(tmp$units, tmp$school, mean, na.rm=TRUE),2)[1])` units, and a median of `r unname(round(tapply(tmp$units, tmp$school, median, na.rm=TRUE),2)[1])` units. CSU Fresno has an average unit workload of `r unname(round(tapply(tmp$units, tmp$school, mean, na.rm=TRUE),2)[2])` units, and a median of `r unname(round(tapply(tmp$units, tmp$school, median, na.rm=TRUE),2)[2])` units. CSU Northridge has an average unit workload of `r unname(round(tapply(tmp$units, tmp$school, mean, na.rm=TRUE),2)[3])` units, and a median of `r unname(round(tapply(tmp$units, tmp$school, median, na.rm=TRUE),2)[3])` units.

## Non-Academic Hours
```{r}
tmp <- tmp2 %>% filter(NonAcademic > 0 | is.na(NonAcademic))
```
**Below is a combination of both paid and unpaid hours worked by students to get a further understanding of the workload participants face on a weekly basis `r print_n_reporting_tmp('NonAcademic')`**  
*Note: below the values corresponding to "41+" were rounded to 41. Values were also filtered so that only people who work (> 0 hours per week) were included.*
```{r, fig.height=8, fig.width=8}
ggplot(tmp, aes(x=NonAcademic, group=school, fill=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v", scales='free') + xlab('Non-Academic Hours') + ylab("Density") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=seq(2,82,10), labels=c(as.character(seq(2,72,10)), "82+"))
```
Looking at the non-academic workload across each campus, it seems the distributions are slightly different for each campus. CSU Chico, who seem to have students who work the most paid/unpaid weekly hours, has an average non-academic workload of `r unname(round(tapply(tmp$NonAcademic, tmp$school, mean, na.rm=TRUE),2)[1])` hours and a median of `r unname(round(tapply(tmp$NonAcademic, tmp$school, median, na.rm=TRUE),2)[1])` hours. CSU Fresno, who seem to have students who work the least paid/unpaid weekly hours, has an average non-academic workload of `r unname(round(tapply(tmp$NonAcademic, tmp$school, mean, na.rm=TRUE),2)[2])` hours and a median of `r unname(round(tapply(tmp$NonAcademic, tmp$school, median, na.rm=TRUE),2)[2])` hours. CSU Northridge, who seem to be between the other two campuses, has an average non-academic workload of `r unname(round(tapply(tmp$NonAcademic, tmp$school, mean, na.rm=TRUE),2)[3])` hours and a median of `r unname(round(tapply(tmp$NonAcademic, tmp$school, median, na.rm=TRUE),2)[3])` hours.

## Total Workload Hours
```{r}
tmp <- tmp2 %>% filter(TotalHours > 0 | is.na(TotalHours))
```
**Below is a combination of all worked hours per week, both academic and non-academic. This includes units (3 hr/unit), paid, and unpaid worked hours `r print_n_reporting_tmp('TotalHours')`**    
*Note: below the values corresponding to "41+" were rounded to 41, as well as values corresponding to "22+" being rounded to 22. Values were also filtered so that only people who work (> 0 hours per week) were included.*
```{r, fig.height=8, fig.width=8}
ggplot(tmp, aes(x=TotalHours, group=school, fill=school)) + geom_histogram(aes(y=..density..), color="black", position = "identity")  +
  geom_density(alpha=0.4, color="black") + facet_wrap(~school, dir="v", scales='free') + xlab('Total Hours') + ylab("Density") + 
  theme(legend.position="none", strip.background = element_rect(fill="#c7dcf0"), strip.text = element_text(size=11)) +
  scale_fill_manual(values=campus.colors) + scale_x_continuous(breaks=c(seq(9,134,10), 134), labels=as.character(c(seq(9,134,10), 134)))
```
Looking at the total workload hours across each campus, again it seems that the distribution are very similar for each. CSU Chico has an average total workload of `r unname(round(tapply(tmp$TotalHours, tmp$school, mean, na.rm=TRUE),2)[1])` hours, and a median of `r unname(round(tapply(tmp$TotalHours, tmp$school, median, na.rm=TRUE),2)[1])` hours. CSU Fresno has an average total workload of `r unname(round(tapply(tmp$TotalHours, tmp$school, mean, na.rm=TRUE),2)[2])` hours, and a median of `r unname(round(tapply(tmp$TotalHours, tmp$school, median, na.rm=TRUE),2)[2])` hours. CSU Northridge has an average total workload of `r unname(round(tapply(tmp$TotalHours, tmp$school, mean, na.rm=TRUE),2)[3])` hours, and a median of `r unname(round(tapply(tmp$TotalHours, tmp$school, median, na.rm=TRUE),2)[3])` hours. A small number of students also claim to work over 100 hours per week across academic and non-academic jobs.

## Table Breakdown
**Below is a breakdown of statistics about the workload taken on by students at each campus that may be of interest to us.**  
*Note: values corresponding to 0 were removed from the below calculations to match the graphs above. We only want to consider students who claim to be working (academic, paid, unpaid) in these statistics. All values with "+" we also rounded down to their whole number.*
```{r}
tmp <- tmp2
tmp[tmp == 0] <- NA

stats <- data.frame(min.units=unname(tapply(tmp$q18, tmp$school, min, na.rm=TRUE)),
                    mean.units=unname(round(tapply(tmp$q18, tmp$school, mean, na.rm=TRUE), 2)),
                    med.units=unname(round(tapply(tmp$q18, tmp$school, median, na.rm=TRUE), 2)),
                    max.units=unname(tapply(tmp$q18, tmp$school, max, na.rm=TRUE)),
                    min.paid=unname(tapply(tmp$q19, tmp$school, min, na.rm=TRUE)),
                    mean.paid=unname(round(tapply(tmp$q19, tmp$school, mean, na.rm=TRUE), 2)),
                    med.paid=unname(round(tapply(tmp$q19, tmp$school, median, na.rm=TRUE), 2)),
                    max.paid=unname(tapply(tmp$q19, tmp$school, max, na.rm=TRUE)),
                    min.unpaid=unname(tapply(tmp$q21, tmp$school, min, na.rm=TRUE)),
                    mean.unpaid=unname(round(tapply(tmp$q21, tmp$school, mean, na.rm=TRUE), 2)),
                    med.unpaid=unname(round(tapply(tmp$q21, tmp$school, median, na.rm=TRUE), 2)),
                    max.unpaid=unname(tapply(tmp$q21, tmp$school, max, na.rm=TRUE)))
rownames(stats) <- sort(unique(tmp$school))
colnames(stats) <- c("Minimum Units", "Mean Units", "Median Units", "Max Units",
                     "Minimum Paid Hours", "Mean Paid Hours", "Median Paid Hours", "Max Paid Hours",
                     "Minimum Unpaid Hours", "Mean Unpaid Hours", "Median Unpaid Hours", "Max Unpaid Hours")

t(stats) %>% kable() %>% kable_styling(bootstrap_options = "striped") %>% column_spec(1, width='4.5cm')
```


---

## [Student Demographics](Campus_Student_Demo.html)
*Click here to go to the Personal Demographics page.*

## [Personal Demographics](Campus_Personal_Demo.html)
*Click here to go to the Personal Demographics page.*